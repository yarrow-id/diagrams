# Documentation

Yarrow's documentation is built using [sphinx](https://www.sphinx-doc.org/en/master/)
and hosted on [readthedocs][docs].

# Building documentation

To build documentation locally, you will need sphinx and some extensions.
Set up a separate virtual environment to build docs as follows:

    python3 -m venv docs.venv
    source docs.venv/bin/activate
    pip install -r docs/requirements.txt

Then build the docs using the Makefile:

    cd docs
    make html

# Documentation file structure

The sphinx documentation source files can be found in
[./docs/source](./docs/source).
The top-level documentation file is `index.rst`, which generates the page you
see when you visit 
[readthedocs](https://yarrow-diagrams.readthedocs.io/en/latest/).
Other top-level sections can be found in their corresponding `.rst` files.

## Autosummary and the `module.rst` template

The [`api_reference.rst`](./docs/source/api_reference.rst) file uses
[autosummary][autosummary] to generate an API reference from docstrings.
In order to get detailed module pages, there's a template file in
[`docs/source/_templates/autosummary/module.rst`](`./docs/source/_templates/autosummary/module.rst`)
which tells sphinx how to generate the documentation for each module.

# Troubleshooting

Sometimes autosummary's autogenerated .rst files can sometimes survive even
after a `make clean`.
If you're running into strange errors, it can help to run the following:

    make clean
    rm -r source/_autosummary
    make html

[docs]: https://yarrow-diagrams.readthedocs.io/
[autosummary]: https://www.sphinx-doc.org/en/master/usage/extensions/autosummary.html
